Using TensorFlow backend.
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcublas.so.8.0 locally
I tensorflow/stream_executor/dso_loader.cc:126] Couldn't open CUDA library libcudnn.so.5. LD_LIBRARY_PATH: 
I tensorflow/stream_executor/cuda/cuda_dnn.cc:3517] Unable to load cuDNN DSO
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcufft.so.8.0 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcuda.so.1 locally
I tensorflow/stream_executor/dso_loader.cc:135] successfully opened CUDA library libcurand.so.8.0 locally
Reading Glove vectors... 
Creating embedding matrix for Keras... 
Iterating over question samples to extract metadata...
Data generator initialized
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE3 instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:910] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
I tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 0 with properties: 
name: Tesla K80
major: 3 minor: 7 memoryClockRate (GHz) 0.8235
pciBusID 0000:00:04.0
Total memory: 11.17GiB
Free memory: 11.11GiB
W tensorflow/stream_executor/cuda/cuda_driver.cc:590] creating context when one is currently active; existing: 0x248ea90
I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:910] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
I tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 1 with properties: 
name: Tesla K80
major: 3 minor: 7 memoryClockRate (GHz) 0.8235
pciBusID 0000:00:05.0
Total memory: 11.17GiB
Free memory: 11.11GiB
W tensorflow/stream_executor/cuda/cuda_driver.cc:590] creating context when one is currently active; existing: 0x20c1330
I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:910] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
I tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 2 with properties: 
name: Tesla K80
major: 3 minor: 7 memoryClockRate (GHz) 0.8235
pciBusID 0000:00:06.0
Total memory: 11.17GiB
Free memory: 11.11GiB
W tensorflow/stream_executor/cuda/cuda_driver.cc:590] creating context when one is currently active; existing: 0x233a1e0
I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:910] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
I tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 3 with properties: 
name: Tesla K80
major: 3 minor: 7 memoryClockRate (GHz) 0.8235
pciBusID 0000:00:07.0
Total memory: 11.17GiB
Free memory: 11.11GiB
I tensorflow/core/common_runtime/gpu/gpu_device.cc:777] Peer access not supported between device ordinals 0 and 1
I tensorflow/core/common_runtime/gpu/gpu_device.cc:777] Peer access not supported between device ordinals 0 and 2
I tensorflow/core/common_runtime/gpu/gpu_device.cc:777] Peer access not supported between device ordinals 0 and 3
I tensorflow/core/common_runtime/gpu/gpu_device.cc:777] Peer access not supported between device ordinals 1 and 0
I tensorflow/core/common_runtime/gpu/gpu_device.cc:777] Peer access not supported between device ordinals 1 and 2
I tensorflow/core/common_runtime/gpu/gpu_device.cc:777] Peer access not supported between device ordinals 1 and 3
I tensorflow/core/common_runtime/gpu/gpu_device.cc:777] Peer access not supported between device ordinals 2 and 0
I tensorflow/core/common_runtime/gpu/gpu_device.cc:777] Peer access not supported between device ordinals 2 and 1
I tensorflow/core/common_runtime/gpu/gpu_device.cc:777] Peer access not supported between device ordinals 2 and 3
I tensorflow/core/common_runtime/gpu/gpu_device.cc:777] Peer access not supported between device ordinals 3 and 0
I tensorflow/core/common_runtime/gpu/gpu_device.cc:777] Peer access not supported between device ordinals 3 and 1
I tensorflow/core/common_runtime/gpu/gpu_device.cc:777] Peer access not supported between device ordinals 3 and 2
I tensorflow/core/common_runtime/gpu/gpu_device.cc:906] DMA: 0 1 2 3 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 0:   Y N N N 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 1:   N Y N N 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 2:   N N Y N 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 3:   N N N Y 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:00:04.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:00:05.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:00:06.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:00:07.0)
____________________________________________________________________________________________________
Layer (type)                     Output Shape          Param #     Connected to                     
====================================================================================================
q1_input (InputLayer)            (None, 272)           0                                            
____________________________________________________________________________________________________
q2_input (InputLayer)            (None, 272)           0                                            
____________________________________________________________________________________________________
embedding_1 (Embedding)          (None, 272, 200)      80000400    q1_input[0][0]                   
                                                                   q2_input[0][0]                   
____________________________________________________________________________________________________
gru_1 (GRU)                      (None, 256)           350976      embedding_1[0][0]                
                                                                   embedding_1[1][0]                
____________________________________________________________________________________________________
merge_1 (Merge)                  (None, 512)           0           gru_1[0][0]                      
                                                                   gru_1[1][0]                      
____________________________________________________________________________________________________
dense_1 (Dense)                  (None, 1)             513         merge_1[0][0]                    
====================================================================================================
Total params: 80,351,889
Trainable params: 80,351,889
Non-trainable params: 0
____________________________________________________________________________________________________
None
Epoch 1/10
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 25324 get requests, put_count=7560 evicted_count=1000 eviction_rate=0.132275 and unsatisfied allocation rate=0.744906
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:259] Raising pool_size_limit_ from 100 to 110
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 7442 get requests, put_count=16453 evicted_count=9000 eviction_rate=0.547013 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 930 get requests, put_count=1936 evicted_count=1000 eviction_rate=0.516529 and unsatisfied allocation rate=0.00752688
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:259] Raising pool_size_limit_ from 146 to 160
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 8253 get requests, put_count=18267 evicted_count=10000 eviction_rate=0.547435 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 1693 get requests, put_count=3710 evicted_count=2000 eviction_rate=0.539084 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 9906 get requests, put_count=21923 evicted_count=12000 eviction_rate=0.54737 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 2488 get requests, put_count=5509 evicted_count=3000 eviction_rate=0.544563 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 10720 get requests, put_count=23741 evicted_count=13000 eviction_rate=0.547576 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 3307 get requests, put_count=7334 evicted_count=4000 eviction_rate=0.545405 and unsatisfied allocation rate=0.000302389
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 11524 get requests, put_count=25551 evicted_count=14000 eviction_rate=0.547924 and unsatisfied allocation rate=8.67754e-05
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 4971 get requests, put_count=11004 evicted_count=6000 eviction_rate=0.545256 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 12424 get requests, put_count=28457 evicted_count=16000 eviction_rate=0.562252 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 5795 get requests, put_count=12839 evicted_count=7000 eviction_rate=0.545214 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 37697 get requests, put_count=36396 evicted_count=17000 eviction_rate=0.467084 and unsatisfied allocation rate=0.486643
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:259] Raising pool_size_limit_ from 493 to 542
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 7467 get requests, put_count=16521 evicted_count=9000 eviction_rate=0.544761 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 872 get requests, put_count=1937 evicted_count=1000 eviction_rate=0.516262 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 9105 get requests, put_count=20170 evicted_count=11000 eviction_rate=0.545364 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 2511 get requests, put_count=5590 evicted_count=3000 eviction_rate=0.536673 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 10746 get requests, put_count=23825 evicted_count=13000 eviction_rate=0.545645 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 4197 get requests, put_count=9292 evicted_count=5000 eviction_rate=0.538097 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 11909 get requests, put_count=27004 evicted_count=15000 eviction_rate=0.555473 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 6712 get requests, put_count=14816 evicted_count=8000 eviction_rate=0.539957 and unsatisfied allocation rate=0.000148987
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 39291 get requests, put_count=39727 evicted_count=18000 eviction_rate=0.453092 and unsatisfied allocation rate=0.449696
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:259] Raising pool_size_limit_ from 1158 to 1273
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 8330 get requests, put_count=18445 evicted_count=10000 eviction_rate=0.542152 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 2587 get requests, put_count=5714 evicted_count=3000 eviction_rate=0.525026 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 10827 get requests, put_count=23954 evicted_count=13000 eviction_rate=0.542707 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 4241 get requests, put_count=9380 evicted_count=5000 eviction_rate=0.533049 and unsatisfied allocation rate=0.000235793
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 11923 get requests, put_count=27062 evicted_count=15000 eviction_rate=0.554283 and unsatisfied allocation rate=8.38715e-05
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 6720 get requests, put_count=14874 evicted_count=8000 eviction_rate=0.537851 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 966 get requests, put_count=2135 evicted_count=1000 eviction_rate=0.468384 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 9189 get requests, put_count=20358 evicted_count=11000 eviction_rate=0.540328 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 3445 get requests, put_count=7631 evicted_count=4000 eviction_rate=0.524178 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 11609 get requests, put_count=25795 evicted_count=14000 eviction_rate=0.542741 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 5955 get requests, put_count=13159 evicted_count=7000 eviction_rate=0.531955 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 1010 get requests, put_count=2235 evicted_count=1000 eviction_rate=0.447427 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 9244 get requests, put_count=20468 evicted_count=11000 eviction_rate=0.537424 and unsatisfied allocation rate=0.000108178
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 3496 get requests, put_count=7743 evicted_count=4000 eviction_rate=0.516596 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 11120 get requests, put_count=25367 evicted_count=14000 eviction_rate=0.551898 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 6830 get requests, put_count=15102 evicted_count=8000 eviction_rate=0.529731 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 1898 get requests, put_count=4197 evicted_count=2000 eviction_rate=0.476531 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 10129 get requests, put_count=22428 evicted_count=12000 eviction_rate=0.535045 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 6037 get requests, put_count=13366 evicted_count=7000 eviction_rate=0.523717 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 1937 get requests, put_count=4299 evicted_count=2000 eviction_rate=0.465224 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 10177 get requests, put_count=22539 evicted_count=12000 eviction_rate=0.53241 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 6099 get requests, put_count=13497 evicted_count=7000 eviction_rate=0.518634 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 2012 get requests, put_count=4450 evicted_count=2000 eviction_rate=0.449438 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 9580 get requests, put_count=22018 evicted_count=12000 eviction_rate=0.545009 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 6988 get requests, put_count=15470 evicted_count=8000 eviction_rate=0.51713 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 4560 get requests, put_count=10090 evicted_count=5000 eviction_rate=0.49554 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 2138 get requests, put_count=4721 evicted_count=2000 eviction_rate=0.423639 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 9076 get requests, put_count=21659 evicted_count=12000 eviction_rate=0.554042 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 7669 get requests, put_count=17310 evicted_count=9000 eviction_rate=0.519931 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 7148 get requests, put_count=15853 evicted_count=8000 eviction_rate=0.504636 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 6400 get requests, put_count=14176 evicted_count=7000 eviction_rate=0.493792 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 5635 get requests, put_count=12489 evicted_count=6000 eviction_rate=0.480423 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 5864 get requests, put_count=13803 evicted_count=7000 eviction_rate=0.507136 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 1774 get requests, put_count=3910 evicted_count=1000 eviction_rate=0.255754 and unsatisfied allocation rate=0
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 39844 get requests, put_count=40999 evicted_count=5000 eviction_rate=0.121954 and unsatisfied allocation rate=0.127874
I tensorflow/core/common_runtime/gpu/pool_allocator.cc:259] Raising pool_size_limit_ from 13752 to 15127
/home/tianwang/.local/lib/python3.5/site-packages/keras/engine/training.py:1573: UserWarning: Epoch comprised more than `samples_per_epoch` samples, which might affect learning results. Set `samples_per_epoch` correctly to avoid this warning.
  warnings.warn('Epoch comprised more than '
7027s - loss: 0.5314 - acc: 0.7350 - val_loss: 0.4902 - val_acc: 0.7658
Epoch 2/10
